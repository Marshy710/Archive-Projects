VERSION 5.00
Object = "{E3583FCE-0595-4681-9ACD-48F7805DEFE1}#1.0#0"; "glxpbuttonz.ocx"
Begin VB.Form frmMainUser 
   Caption         =   "Salon De Grab Management System"
   ClientHeight    =   10950
   ClientLeft      =   225
   ClientTop       =   555
   ClientWidth     =   16200
   LinkTopic       =   "Form1"
   MaxButton       =   0   'False
   ScaleHeight     =   10950
   ScaleWidth      =   16200
   StartUpPosition =   2  'CenterScreen
   Begin glxpbuttonz.UserButtonz UserButtonz7 
      CausesValidation=   0   'False
      Height          =   255
      Left            =   14520
      TabIndex        =   0
      TabStop         =   0   'False
      Top             =   4080
      Width           =   255
      _ExtentX        =   450
      _ExtentY        =   450
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Tekton Pro Ext"
         Size            =   9
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Caption         =   ""
      IconHighLiteColor=   0
      CaptionHighLiteColor=   0
      Style           =   1
      Checked         =   0   'False
      ColorButtonHover=   16761087
      ColorButtonUp   =   16761087
      ColorButtonDown =   16761087
      BorderBrightness=   0
      ColorBright     =   16772528
      DisplayHand     =   0   'False
      ColorScheme     =   0
   End
   Begin glxpbuttonz.UserButtonz UserButtonz6 
      CausesValidation=   0   'False
      Height          =   375
      Left            =   14640
      TabIndex        =   15
      TabStop         =   0   'False
      Top             =   3720
      Width           =   375
      _ExtentX        =   661
      _ExtentY        =   661
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Tekton Pro Ext"
         Size            =   9
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Caption         =   ""
      IconHighLiteColor=   0
      CaptionHighLiteColor=   0
      Style           =   1
      Checked         =   0   'False
      ColorButtonHover=   16761087
      ColorButtonUp   =   16761087
      ColorButtonDown =   16761087
      BorderBrightness=   0
      ColorBright     =   16772528
      DisplayHand     =   0   'False
      ColorScheme     =   0
   End
   Begin glxpbuttonz.UserButtonz UserButtonz10 
      CausesValidation=   0   'False
      Height          =   495
      Left            =   14520
      TabIndex        =   2
      TabStop         =   0   'False
      Top             =   3240
      Width           =   495
      _ExtentX        =   873
      _ExtentY        =   873
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Tekton Pro Ext"
         Size            =   9
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Caption         =   ""
      IconHighLiteColor=   0
      CaptionHighLiteColor=   0
      Style           =   1
      Checked         =   0   'False
      ColorButtonHover=   16761087
      ColorButtonUp   =   16761087
      ColorButtonDown =   16761087
      BorderBrightness=   0
      ColorBright     =   16772528
      DisplayHand     =   0   'False
      ColorScheme     =   0
   End
   Begin glxpbuttonz.UserButtonz UserButtonz8 
      CausesValidation=   0   'False
      Height          =   615
      Left            =   14280
      TabIndex        =   1
      TabStop         =   0   'False
      Top             =   2760
      Width           =   615
      _ExtentX        =   1085
      _ExtentY        =   1085
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Tekton Pro Ext"
         Size            =   9
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Caption         =   ""
      IconHighLiteColor=   0
      CaptionHighLiteColor=   0
      Style           =   1
      Checked         =   0   'False
      ColorButtonHover=   16761087
      ColorButtonUp   =   16744703
      ColorButtonDown =   16761087
      BorderBrightness=   0
      ColorBright     =   16777152
      DisplayHand     =   0   'False
      ColorScheme     =   0
   End
   Begin glxpbuttonz.UserButtonz UserButtonz20 
      CausesValidation=   0   'False
      Height          =   495
      Left            =   1200
      TabIndex        =   4
      TabStop         =   0   'False
      Top             =   3240
      Width           =   495
      _ExtentX        =   873
      _ExtentY        =   873
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Tekton Pro Ext"
         Size            =   9
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Caption         =   ""
      IconHighLiteColor=   0
      CaptionHighLiteColor=   0
      Style           =   1
      Checked         =   0   'False
      ColorButtonHover=   16761087
      ColorButtonUp   =   16761087
      ColorButtonDown =   16761087
      BorderBrightness=   0
      ColorBright     =   16772528
      DisplayHand     =   0   'False
      ColorScheme     =   0
   End
   Begin glxpbuttonz.UserButtonz UserButtonz9 
      CausesValidation=   0   'False
      Height          =   375
      Left            =   1320
      TabIndex        =   5
      TabStop         =   0   'False
      Top             =   3720
      Width           =   375
      _ExtentX        =   661
      _ExtentY        =   661
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Tekton Pro Ext"
         Size            =   9
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Caption         =   ""
      IconHighLiteColor=   0
      CaptionHighLiteColor=   0
      Style           =   1
      Checked         =   0   'False
      ColorButtonHover=   16761087
      ColorButtonUp   =   16761087
      ColorButtonDown =   16761087
      BorderBrightness=   0
      ColorBright     =   16772528
      DisplayHand     =   0   'False
      ColorScheme     =   0
   End
   Begin glxpbuttonz.UserButtonz UserButtonz14 
      CausesValidation=   0   'False
      Height          =   255
      Left            =   1560
      TabIndex        =   6
      TabStop         =   0   'False
      Top             =   4080
      Width           =   255
      _ExtentX        =   450
      _ExtentY        =   450
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Tekton Pro Ext"
         Size            =   9
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Caption         =   ""
      IconHighLiteColor=   0
      CaptionHighLiteColor=   0
      Style           =   1
      Checked         =   0   'False
      ColorButtonHover=   16761087
      ColorButtonUp   =   16761087
      ColorButtonDown =   16761087
      BorderBrightness=   0
      ColorBright     =   16772528
      DisplayHand     =   0   'False
      ColorScheme     =   0
   End
   Begin glxpbuttonz.UserButtonz UserButtonz16 
      CausesValidation=   0   'False
      Height          =   615
      Left            =   1440
      TabIndex        =   3
      TabStop         =   0   'False
      Top             =   2760
      Width           =   615
      _ExtentX        =   1085
      _ExtentY        =   1085
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Tekton Pro Ext"
         Size            =   9
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Caption         =   ""
      IconHighLiteColor=   0
      CaptionHighLiteColor=   0
      Style           =   1
      Checked         =   0   'False
      ColorButtonHover=   16761087
      ColorButtonUp   =   16744703
      ColorButtonDown =   16761087
      BorderBrightness=   0
      ColorBright     =   16777152
      DisplayHand     =   0   'False
      ColorScheme     =   0
   End
   Begin VB.PictureBox Picture1 
      Appearance      =   0  'Flat
      AutoSize        =   -1  'True
      BackColor       =   &H80000005&
      BorderStyle     =   0  'None
      FillStyle       =   2  'Horizontal Line
      ForeColor       =   &H80000008&
      Height          =   8640
      Left            =   1680
      Picture         =   "frmMainUser.frx":0000
      ScaleHeight     =   8640
      ScaleWidth      =   12960
      TabIndex        =   11
      Top             =   2880
      Width           =   12960
      Begin VB.Label Label2 
         BackStyle       =   0  'Transparent
         Caption         =   "All Rights Reserved I Project v1.0.0"
         ForeColor       =   &H8000000B&
         Height          =   495
         Left            =   5520
         TabIndex        =   14
         Top             =   8160
         Width           =   2655
      End
      Begin VB.Label Label3 
         BackStyle       =   0  'Transparent
         Caption         =   "Salon De Grab Management System  "
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H8000000B&
         Height          =   255
         Left            =   4800
         TabIndex        =   13
         Top             =   7560
         Width           =   3375
      End
      Begin VB.Label Label4 
         BackStyle       =   0  'Transparent
         Caption         =   "All Rights Reserved I Project v1.0.1"
         ForeColor       =   &H8000000B&
         Height          =   495
         Left            =   5160
         TabIndex        =   12
         Top             =   7800
         Width           =   2655
      End
      Begin VB.Image Image4 
         Height          =   8325
         Left            =   0
         Picture         =   "frmMainUser.frx":2EE27
         Top             =   0
         Width           =   12960
      End
   End
   Begin glxpbuttonz.UserButtonz UserButtonz2 
      CausesValidation=   0   'False
      Height          =   735
      Left            =   1560
      TabIndex        =   7
      TabStop         =   0   'False
      Top             =   1800
      Width           =   3255
      _ExtentX        =   5741
      _ExtentY        =   1296
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Tekton Pro Ext"
         Size            =   9
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Caption         =   "&New Transaction "
      IconHighLite    =   -1  'True
      IconHighLiteColor=   16761087
      CaptionHighLiteColor=   0
      Picture         =   "frmMainUser.frx":18E1CB
      Style           =   1
      Checked         =   0   'False
      ColorButtonHover=   16711935
      ColorButtonUp   =   15309136
      ColorButtonDown =   16711935
      BorderBrightness=   0
      ColorBright     =   16772528
      DisplayHand     =   0   'False
      ColorScheme     =   0
   End
   Begin glxpbuttonz.UserButtonz UserButtonz4 
      Height          =   735
      Left            =   4920
      TabIndex        =   8
      Top             =   1800
      Width           =   3255
      _ExtentX        =   5741
      _ExtentY        =   1296
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Tekton Pro Ext"
         Size            =   9
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Caption         =   "&Sales Record "
      IconHighLite    =   -1  'True
      IconHighLiteColor=   16761087
      CaptionHighLiteColor=   0
      Picture         =   "frmMainUser.frx":18EB4F
      Style           =   1
      Checked         =   0   'False
      ColorButtonHover=   16711935
      ColorButtonUp   =   15309136
      ColorButtonDown =   16711935
      BorderBrightness=   0
      ColorBright     =   16772528
      DisplayHand     =   0   'False
      ColorScheme     =   0
   End
   Begin glxpbuttonz.UserButtonz UserButtonz1 
      Height          =   735
      Left            =   8400
      TabIndex        =   9
      Top             =   1800
      Width           =   3255
      _ExtentX        =   5741
      _ExtentY        =   1296
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Tekton Pro Ext"
         Size            =   9
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Caption         =   "&Beauticians' Record"
      IconHighLite    =   -1  'True
      IconHighLiteColor=   16761087
      CaptionHighLiteColor=   0
      Picture         =   "frmMainUser.frx":18F4D3
      Style           =   1
      Checked         =   0   'False
      ColorButtonHover=   16711935
      ColorButtonUp   =   15309136
      ColorButtonDown =   16711935
      BorderBrightness=   0
      ColorBright     =   16772528
      DisplayHand     =   0   'False
      ColorScheme     =   0
   End
   Begin glxpbuttonz.UserButtonz UserButtonz5 
      Height          =   735
      Left            =   11760
      TabIndex        =   10
      Top             =   1800
      Width           =   3255
      _ExtentX        =   5741
      _ExtentY        =   1296
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Tekton Pro Ext"
         Size            =   9
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Caption         =   "&Expenses"
      IconHighLite    =   -1  'True
      IconHighLiteColor=   16761087
      CaptionHighLiteColor=   0
      Picture         =   "frmMainUser.frx":18FE57
      Style           =   1
      Checked         =   0   'False
      ColorButtonHover=   16711935
      ColorButtonUp   =   15309136
      ColorButtonDown =   16711935
      BorderBrightness=   0
      ColorBright     =   16772528
      DisplayHand     =   0   'False
      ColorScheme     =   0
   End
   Begin VB.Image Image2 
      Height          =   2085
      Left            =   480
      Picture         =   "frmMainUser.frx":1907DB
      Stretch         =   -1  'True
      Top             =   1200
      Width           =   15195
   End
   Begin VB.Image Image3 
      Height          =   1500
      Left            =   3480
      Picture         =   "frmMainUser.frx":1A67AF
      Top             =   0
      Width           =   9000
   End
   Begin VB.Image Image6 
      Height          =   1500
      Left            =   3000
      Picture         =   "frmMainUser.frx":1D2713
      Top             =   0
      Width           =   9000
   End
   Begin VB.Image Image1 
      Height          =   12000
      Left            =   0
      Picture         =   "frmMainUser.frx":1FE677
      Stretch         =   -1  'True
      Top             =   0
      Width           =   16260
   End
End
Attribute VB_Name = "frmMainUser"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Private Sub UserButtonz1_Click()

  If varUserAdmin = True Then
     With frmBeauticianList
          .Show vbModal
     End With
  Else

Dim varId As Integer
Dim varName As String
Dim TSubTotal As Recordset
   With frmsearchbox
        .varRecSet = 1
        .Show vbModal
        If .varOk Then
            varId = .varId
            varName = .varName
        Else: Exit Sub
        End If
  End With
  
  With frmDateRange
    .Show vbModal
    If .varOk Then
    
            conTable TSubTotal, "SELECT SUM(trn.serviceAmount) As subTotal " & _
            "FROM (transactionRecord As trn) LEFT JOIN tservicestransaction As tsvr " & _
            "ON trn.transId = tsvr.id WHERE trn.beauticianId = " & varId & _
            " AND format(transactionDate,'mm/dd/yyyy') >= '" & Format(CDate(.varDateFrom), "mm/dd/yyyy") & _
            "' AND format(transactionDate,'mm/dd/yyyy') <= '" & Format(CDate(.varDateTo), "mm/dd/yyyy") & "'"
            
            
            DataEnvironment1.rssqlBeauticianIncome.Open _
            "SELECT trn.id, tsvr.transactiondate, tsvr.transactionNo, svr.servicename, svr.description, trn.serviceAmount " & _
            "FROM ((transactionRecord AS trn) LEFT JOIN tservices As svr ON trn.serviceId = svr.id) " & _
            "LEFT JOIN tservicestransaction As tsvr ON trn.transId = tsvr.id WHERE trn.beauticianId = " & varId & _
            " AND format(transactionDate,'mm/dd/yyyy') >= '" & Format(CDate(.varDateFrom), "mm/dd/yyyy") & _
            "' AND format(transactionDate,'mm/dd/yyyy') <= '" & Format(CDate(.varDateTo), "mm/dd/yyyy") & "'"
            rptBeauticianIncome.Sections("Section5").Controls("lblTotalAmount").Caption = Format(TSubTotal!subTotal, "#,##0.00")
            rptBeauticianIncome.Sections("Section4").Controls("lblBeautician").Caption = varName
            rptBeauticianIncome.Show vbModal
            DataEnvironment1.rssqlBeauticianIncome.Close
    End If
  End With
  End If
End Sub

Private Sub UserButtonz2_Click()
    With frmSelectTable
        .Show vbModal
    End With
End Sub

Private Sub UserButtonz4_Click()
    With frmSalesRecord
        .Show vbModal
    End With

End Sub

Private Sub UserButtonz5_Click()
    With frmExpenses
        .Show vbModal
    End With
End Sub
